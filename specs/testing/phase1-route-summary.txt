================================================================================
3D PRINT SYDNEY - ROUTE & API QUICK REFERENCE
================================================================================

TOTAL INVENTORY
  Page Routes: 46
  API Endpoints: 86
  Route Groups: 3 ((admin), (client), (public))
  
================================================================================
ADMIN PORTAL (46 routes)
================================================================================

DASHBOARD & REPORTS
  /dashboard - Main dashboard
  /dashboard/materials-admin - Materials inventory
  
INVOICING (3 routes)
  /invoices - List all invoices
  /invoices/new - Create invoice
  /invoices/[id] - View/edit invoice detail

QUOTING (3 routes)
  /quotes - List all quotes
  /quotes/new - Create quote
  /quotes/[id] - View/edit quote detail

CLIENTS (3 routes)
  /clients - List clients
  /clients/new - Create client
  /clients/[id] - Client details & management

JOBS (1 route)
  /jobs - Print queue & job management

INVENTORY (2 routes)
  /printers - 3D printer management
  /products - Product templates

USERS (2 routes)
  /users - User list
  /users/[id] - User detail

SETTINGS & HELP (5 routes)
  /account - Admin account settings
  /me - Admin profile
  /messages - Internal messaging
  /settings - System configuration
  /reports - Analytics
  /business-guide - Documentation
  /documentation - Help center

================================================================================
CLIENT PORTAL (10 routes)
================================================================================

OVERVIEW
  /client - Client dashboard

ORDERS & PROJECTS (6 routes)
  /client/orders - Order history
  /client/orders/[id] - Order details
  /client/projects/active - Active projects
  /client/projects/completed - Completed projects
  /client/projects/archived - Archived projects
  /client/projects/history - Project timeline

ACCOUNT
  /client/account - Profile & preferences

QUICK ORDER
  /quick-order - Self-service order with file processing

MESSAGES
  /client/messages - Client inbox

================================================================================
PUBLIC ROUTES (3 routes)
================================================================================

  /login - User login
  /signup - Client registration
  / - Landing page

================================================================================
API ENDPOINTS BY FEATURE
================================================================================

AUTH (6)
  POST /api/auth/login
  POST /api/auth/signup
  POST /api/auth/logout
  GET /api/auth/me
  POST /api/auth/change-password

CLIENTS (7)
  GET/POST /api/clients
  GET/PUT/DELETE /api/clients/[id]
  POST /api/clients/[id]/credit
  POST /api/clients/[id]/notes
  GET/PATCH /api/client/profile
  GET/PATCH /api/client/preferences

INVOICES (18)
  GET/POST /api/invoices
  GET/PUT/DELETE /api/invoices/[id]
  POST /api/invoices/[id]/mark-paid
  POST /api/invoices/[id]/mark-unpaid
  POST /api/invoices/[id]/void
  POST /api/invoices/[id]/write-off
  POST /api/invoices/[id]/revert
  POST /api/invoices/[id]/apply-credit
  GET/POST /api/invoices/[id]/attachments
  DELETE /api/invoices/[id]/attachments/[id]
  GET /api/invoices/[id]/files
  POST /api/invoices/[id]/payments
  DELETE /api/invoices/[id]/payments/[id]
  GET/POST /api/invoices/[id]/messages
  GET /api/invoices/[id]/activity
  POST /api/invoices/[id]/stripe-session
  GET /api/client/invoices

QUOTES (10)
  GET/POST /api/quotes
  GET/PUT/DELETE /api/quotes/[id]
  POST /api/quotes/[id]/send
  POST /api/quotes/[id]/status
  POST /api/quotes/[id]/accept
  POST /api/quotes/[id]/decline
  POST /api/quotes/[id]/convert
  POST /api/quotes/[id]/duplicate

JOBS (7)
  GET/POST /api/jobs
  GET/PATCH /api/jobs/[id]
  POST /api/jobs/[id]/status
  POST /api/jobs/[id]/archive
  POST /api/jobs/archive
  POST /api/jobs/reorder
  GET /api/client/jobs

QUICK ORDER (6)
  POST /api/quick-order/upload
  POST /api/quick-order/orient
  POST /api/quick-order/slice
  POST /api/quick-order/analyze-supports
  POST /api/quick-order/price
  POST /api/quick-order/checkout

MATERIALS (4)
  GET/POST /api/materials
  PUT/DELETE /api/materials/[id]
  GET /api/client/materials

PRINTERS (5)
  GET/POST /api/printers
  PUT/DELETE /api/printers/[id]
  POST /api/printers/[id]/clear-queue

PRODUCT TEMPLATES (4)
  GET/POST /api/product-templates
  PUT/DELETE /api/product-templates/[id]

PROJECTS (3)
  GET /api/client/projects
  POST /api/projects/[id]/reorder
  POST /api/projects/archive

ATTACHMENTS & FILES (3)
  GET /api/attachments/[id]
  GET /api/order-files/[id]
  GET /api/order-files/[id]/download

DASHBOARD & ANALYTICS (2)
  GET /api/dashboard
  GET /api/dashboard/activity
  GET /api/client/dashboard

MESSAGING & NOTIFICATIONS (4)
  GET/POST /api/messages
  GET/PATCH /api/notifications
  GET /api/client/notifications
  GET /api/admin/messages/conversations
  GET/POST /api/admin/users/[id]/messages

EXPORT & REPORTING (6)
  GET /api/export/invoices
  GET /api/export/payments
  GET /api/export/jobs
  GET /api/export/material-usage
  GET /api/export/ar-aging
  GET /api/export/printer-utilization

SETTINGS (1)
  GET/PUT /api/settings

EXTERNAL (3)
  POST /api/stripe/webhook
  POST /api/stripe/test
  POST /api/webhooks/resend

UTILITY (2)
  GET /api/tmp-file/[...id]
  POST /api/maintenance/run

================================================================================
AUTHENTICATION & AUTHORIZATION
================================================================================

CLIENT ROLE
  - Access: (client)/* routes
  - Can view own invoices/quotes
  - Can use quick-order
  - Enforced by requireClient() in layout.tsx

ADMIN ROLE
  - Access: (admin)/* routes + all admin APIs
  - Full CRUD on invoices, quotes, clients, jobs
  - Access to settings, reports, exports
  - Enforced by requireAdmin() in layout.tsx

PUBLIC (No Auth)
  - (public)/* routes (login, signup, landing)
  - All public routes auto-redirect authenticated users

API PROTECTION PATTERNS
  - requireAdmin(request) - Admin-only APIs
  - requireClientWithId(request) - Client-specific APIs
  - requireAuth(request) - Any authenticated user
  - No auth - Public endpoints

SESSION
  - HTTP-only cookie: sb:token
  - JWT format with expiration
  - Validated on every request

================================================================================
KEY FEATURES
================================================================================

BILLING & INVOICING
  - Full invoice lifecycle (draft → sent → paid/void/write-off)
  - Payment tracking with records
  - Credit application
  - Stripe integration

QUOTING
  - Quote creation & editing
  - Multi-state workflow
  - Client acceptance/decline
  - Convert to invoice

3D PRINT MANAGEMENT
  - Job queue with status
  - Printer inventory
  - Material tracking & pricing

QUICK ORDER / SELF-SERVICE
  - File upload processing
  - 3D model manipulation (orient, slice, support analysis)
  - Real-time pricing
  - Direct checkout

CLIENT PORTAL
  - Order & project tracking
  - Invoice viewing/payment
  - Quick ordering
  - Messaging

ADMIN DASHBOARD
  - KPI metrics
  - Activity feed
  - Multiple reports (AR aging, material usage, printer utilization)
  - Bulk exports (CSV/Excel)

USER MANAGEMENT
  - Staff user creation
  - Client management with credit
  - Internal messaging

================================================================================
TESTING PRIORITIES
================================================================================

CRITICAL PATH
  1. Auth flow (login/signup/logout)
  2. Invoice CRUD + payment flow
  3. Quote workflow (create → send → accept/decline → convert)
  4. Quick order (upload → price → checkout)
  5. Client dashboard access control

ROLE-BASED
  1. Admin can access all routes & APIs
  2. Client cannot access /dashboard/* or admin APIs
  3. Public routes redirect authenticated users

INTEGRATION POINTS
  1. Stripe webhook → invoice payment
  2. Email (Resend) webhook handling
  3. File processing in quick-order

================================================================================
